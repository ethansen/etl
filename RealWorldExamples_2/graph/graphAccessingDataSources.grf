<?xml version="1.0" encoding="UTF-8"?>
<Graph author="Petr" created="Thu Jul 01 14:14:48 CEST 2010" guiVersion="3.3.0.P" id="1277991711576" licenseType="Community" modified="Tue Dec 04 21:04:04 CST 2012" modifiedBy="erichansen" name="graphAccessingDataSources" revision="1.86" showComponentDetails="true">
<Global>
<Metadata id="Metadata3" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="FileURL" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field eofAsDelimiter="true" name="fileURL" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata2" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="Orders" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" recordSize="-1" type="delimited">
<Field format="#" name="OrderID" type="integer"/>
<Field name="CustomerID" type="string"/>
<Field name="EmployeeID" type="integer"/>
<Field format="dd.MM.yyyy" name="OrderDate" type="date"/>
<Field format="dd.MM.yyyy" name="RequiredDate" type="date"/>
<Field format="dd.MM.yyyy" name="ShippedDate" type="date"/>
<Field format="#" name="ShipVia" type="integer"/>
<Field name="Freight" type="integer"/>
<Field name="ShipName" type="string"/>
<Field name="ShipAddress" type="string"/>
<Field name="ShipCity" type="string"/>
<Field name="ShipRegion" type="string"/>
<Field name="ShipPostalCode" type="string"/>
<Field name="ShipCountry" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata4" previewAttachment="${DATAIN_DIR}/Orders_Argentina.csv" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="orders_country" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" skipSourceRows="0" type="delimited">
<Field name="OrderID" type="string"/>
<Field name="CustomerID" type="string"/>
<Field name="EmployeeID" type="string"/>
<Field name="OrderDate" type="string"/>
<Field name="RequiredDate" type="string"/>
<Field name="ShippedDate" type="string"/>
<Field name="ShipVia" type="string"/>
<Field name="Freight" type="string"/>
<Field name="ShipName" type="string"/>
<Field name="ShipAddress" type="string"/>
<Field name="ShipCity" type="string"/>
<Field name="ShipRegion" type="string"/>
<Field name="ShipPostalCode" type="string"/>
<Field name="ShipCountry" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata0" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="Orders_with_autofilling" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" recordSize="-1" type="delimited">
<Field format="#" name="OrderID" type="number"/>
<Field name="CustomerID" type="string"/>
<Field name="EmployeeID" type="integer"/>
<Field format="dd.MM.yyyy" name="OrderDate" type="date"/>
<Field format="dd.MM.yyyy" name="RequiredDate" type="date"/>
<Field format="dd.MM.yyyy" name="ShippedDate" type="date"/>
<Field format="#" name="ShipVia" type="integer"/>
<Field name="Freight" type="number"/>
<Field name="ShipName" type="string"/>
<Field name="ShipAddress" type="string"/>
<Field name="ShipCity" type="string"/>
<Field name="ShipRegion" type="string"/>
<Field name="ShipPostalCode" type="string"/>
<Field auto_filling="sheet_name" name="ShipCountry" type="string"/>
<Field auto_filling="&quot;to be in use&quot;" name="Constant" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata5" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="OrdersCount" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\n" recordSize="-1" type="delimited">
<Field auto_filling="sheet_name" name="From" type="string"/>
<Field name="Count" type="integer"/>
</Record>
</Metadata>
<Property id="GraphParameter0" name="CONST" value="ORDERS."/>
<Property fileURL="workspace.prm" id="GraphParameter1"/>
<Note alignment="1" backgroundColorB="225" backgroundColorG="255" backgroundColorR="255" folded="false" height="209" id="Note0" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="Autofilling metadata feature" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="361" x="24" y="58">
<attr name="text"><![CDATA[Input data read from Excel file containing the data organized into sheets by country.
Autofilling enriches the data set by sheet name (country name) and is defined for the field ShipCountry.
]]></attr>
</Note>
<Note alignment="1" backgroundColorB="225" backgroundColorG="255" backgroundColorR="255" folded="false" height="404" id="Note1" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="Archived files" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="242" x="24" y="273">
<attr name="text"><![CDATA[Clover can read data from zipped/gzipped/tar files. You can select specific file(s) or use wildcards (?,*).]]></attr>
</Note>
<Note alignment="1" backgroundColorB="225" backgroundColorG="255" backgroundColorR="255" folded="false" height="249" id="Note2" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="Input port reading" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="196" x="25" y="708">
<attr name="text"><![CDATA[Clover is able to read files (URLs) stored externally. In this way you can easily parameterize the graph processing. Instead of a specific URL, a special syntax is used - each record of a single field represents the URL of an input file:

port:$0.fileURL:source]]></attr>
</Note>
<Note alignment="1" backgroundColorB="0" backgroundColorG="196" backgroundColorR="255" folded="false" height="37" id="Note3" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="How many orders were sent from abroad?" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="829" x="24" y="10"/>
<Note alignment="1" backgroundColorB="225" backgroundColorG="255" backgroundColorR="255" folded="false" height="246" id="Note4" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="Aggregator" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="374" x="446" y="191">
<attr name="text"><![CDATA[Records with the same "ShipCountry" key field value are grouped and the aggregation function count() is applied.

Mapping to output fields:

1.  If non-key fields are being mapped using an aggregation function is a must

2. if key fields are being mapped
 - input field (ShipCountry)
 - function (count())
 - constant 
]]></attr>
</Note>
<Dictionary/>
</Global>
<Phase number="0">
<Node aggregateKey="ShipCountry;" enabled="enabled" guiHeight="65" guiName="how many from?" guiWidth="128" guiX="449" guiY="100" id="AGGREGATE0" mapping="$From:=$ShipCountry;$Count:=count();" sorted="false" type="AGGREGATE"/>
<Node enabled="enabled" fileURL="tar:(gzip:(${DATAIN_DIR}/delimited/Orders.TGZ))#Orders_Spain.csv" guiHeight="77" guiName="1 sheet from .TGZ" guiWidth="132" guiX="67" guiY="463" id="DATA_READER3" skipLeadingBlanks="false" skipRows="1" type="DATA_READER">
<attr name="guiDescription"><![CDATA[One file]]></attr>
</Node>
<Node enabled="enabled" fileURL="tar:(${DATAIN_DIR}/delimited/Orders.tar)#Orders_Br*.csv" guiHeight="77" guiName="selects from .tar" guiWidth="128" guiX="71" guiY="566" id="DATA_READER4" skipRows="1" type="DATA_READER">
<attr name="guiDescription"><![CDATA[Wildcard usage]]></attr>
</Node>
<Node debugPrint="true" enabled="enabled" guiHeight="65" guiName="prints to stdout" guiWidth="128" guiX="681" guiY="100" id="TRASH0" type="TRASH"/>
<Node enabled="enabled" fileURL="${DATAIN_DIR}/delimited/Orders.xlsx" guiHeight="89" guiName="reads whole .xlsx" guiWidth="128" guiX="136" guiY="156" id="XLS_READER0" sheetName="*" type="XLS_READER"/>
<Edge debugMode="true" fromNode="AGGREGATE0:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge1" inPort="Port 0 (in)" metadata="Metadata5" outPort="Port 0 (out)" toNode="TRASH0:0"/>
<Edge fromNode="DATA_READER3:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge8" inPort="Port 1 (in)" metadata="Metadata4" outPort="Port 0 (output)" toNode="CONCATENATE0:1"/>
<Edge fromNode="DATA_READER4:0" guiBendpoints="51:0|51:-81" guiLocks="null|null|null" guiRouter="Manual" id="Edge9" inPort="Port 2 (in)" metadata="Metadata4" outPort="Port 0 (output)" toNode="CONCATENATE0:2"/>
<Edge debugMode="false" fromNode="XLS_READER0:0" guiBendpoints="104:0|104:-56" guiLocks="null|null|null" guiRouter="Manual" id="Edge0" inPort="Port 0 (in)" metadata="Metadata0" outPort="Port 0 (out)" toNode="AGGREGATE0:0"/>
</Phase>
<Phase number="1">
<Node aggregateKey="ShipCountry" enabled="enabled" guiHeight="65" guiName="how many from?" guiWidth="128" guiX="861" guiY="457" id="AGGREGATE1" mapping="$From:=$ShipCountry;$Count:=count();" sorted="false" type="AGGREGATE"/>
<Node enabled="enabled" guiHeight="80" guiName="concatenates" guiWidth="128" guiX="294" guiY="457" id="CONCATENATE0" type="CONCATENATE"/>
<Node enabled="enabled" fileURL="zip:(./data-in/delimited/Orders.zip)#Orders_Argentina.csv;zip:(./data-in/delimited/Orders.zip)#Orders_Brazil.csv;zip:(./data-in/delimited/Orders.zip)#Orders_Venezuela.csv;" guiHeight="77" guiName="3 sheets from .zip" guiWidth="133" guiX="67" guiY="366" id="DATA_READER0" skipSourceRows="1" type="DATA_READER">
<attr name="guiDescription"><![CDATA[List of files]]></attr>
</Node>
<Node append="false" enabled="enabled" fileURL="${DATATMP_DIR}/had_duplicate_records.txt" guiHeight="89" guiName="has duplicate" guiWidth="128" guiX="861" guiY="587" id="DATA_WRITER0" outputFieldNames="true" type="DATA_WRITER">
<attr name="guiDescription"><![CDATA[Writes duplicates to tmp file]]></attr>
</Node>
<Node dedupKey="OrderID(a);ShipCountry(a)" enabled="enabled" guiHeight="65" guiName="removes duplicates" guiWidth="141" guiX="660" guiY="457" id="DEDUP0" type="DEDUP"/>
<Node enabled="enabled" guiHeight="89" guiName="sorts" guiWidth="128" guiX="482" guiY="457" id="EXT_SORT0" sortKey="OrderID(a);ShipCountry(a)" type="EXT_SORT"/>
<Node debugPrint="true" enabled="enabled" guiHeight="65" guiName="prints to stdout" guiWidth="128" guiX="1045" guiY="457" id="TRASH1" type="TRASH"/>
<Edge debugMode="false" fromNode="AGGREGATE1:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge3" inPort="Port 0 (in)" metadata="Metadata5" outPort="Port 0 (out)" toNode="TRASH1:0"/>
<Edge debugMode="false" fromNode="CONCATENATE0:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge2" inPort="Port 0 (in)" metadata="Metadata4" outPort="Port 0 (out)" toNode="EXT_SORT0:0"/>
<Edge fromNode="DATA_READER0:0" guiBendpoints="48:0|48:87" guiLocks="null|null|null" guiRouter="Manual" id="Edge7" inPort="Port 0 (in)" metadata="Metadata4" outPort="Port 0 (output)" toNode="CONCATENATE0:0"/>
<Edge debugMode="false" fromNode="DEDUP0:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge13" inPort="Port 0 (in)" metadata="Metadata4" outPort="Port 0 (unique)" toNode="AGGREGATE1:0"/>
<Edge fromNode="DEDUP0:1" guiBendpoints="10:0|10:110" guiLocks="null|null|null" guiRouter="Manual" id="Edge11" inPort="Port 0 (in)" metadata="Metadata4" outPort="Port 1 (duplicate)" toNode="DATA_WRITER0:0"/>
<Edge debugMode="false" fromNode="EXT_SORT0:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge12" inPort="Port 0 (in)" metadata="Metadata4" outPort="Port 0 (out)" toNode="DEDUP0:0"/>
</Phase>
<Phase number="2">
<Node aggregateKey="ShipCountry" enabled="enabled" guiHeight="65" guiName="how many from?" guiWidth="128" guiX="625" guiY="707" id="AGGREGATE2" mapping="$From:=$ShipCountry;$Count:=count();" sorted="false" type="AGGREGATE"/>
<Node enabled="enabled" fileURL="port:$0.fileURL:source" guiHeight="89" guiName="reads files data" guiWidth="128" guiX="433" guiY="707" id="DATA_READER1" skipSourceRows="1" type="DATA_READER"/>
<Node enabled="enabled" fileURL="${DATAIN_DIR}/delimited/filenames.txt" guiHeight="89" guiName="reads files location" guiWidth="138" guiX="236" guiY="707" id="DATA_READER2" type="DATA_READER"/>
<Node debugFilename="${DATAOUT_DIR}/others/NumberOfCustomers.out" debugPrint="true" enabled="enabled" guiHeight="65" guiName="prints debug in file" guiWidth="139" guiX="823" guiY="707" id="TRASH2" type="TRASH"/>
<Edge debugMode="false" fromNode="AGGREGATE2:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge4" inPort="Port 0 (in)" metadata="Metadata5" outPort="Port 0 (out)" toNode="TRASH2:0"/>
<Edge debugMode="false" fromNode="DATA_READER1:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge5" inPort="Port 0 (in)" metadata="Metadata4" outPort="Port 0 (output)" toNode="AGGREGATE2:0"/>
<Edge fromNode="DATA_READER2:0" guiBendpoints="" guiLocks="null|null|null" guiRouter="Manhattan" id="Edge6" inPort="Port 0 (input)" metadata="Metadata3" outPort="Port 0 (output)" toNode="DATA_READER1:0"/>
</Phase>
</Graph>
